<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:HanumanInstitute.YangDownloader"
        xmlns:ui="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia"
        xmlns:hic="clr-namespace:HanumanInstitute.Common.Avalonia;assembly=Common.Avalonia"
        mc:Ignorable="d" MinWidth="350" Width="350" MinHeight="220" Height="220"
        x:Class="HanumanInstitute.YangDownloader.Views.SettingsView"
        Title="Settings" Classes="gradient"
        ShowInTaskbar="False" WindowStartupLocation="CenterOwner"
        d:DataContext="{x:Static local:ViewModelLocator.Settings}">
    <Window.Resources>
        <hic:BooleanToBrushConverter x:Key="BooleanToBrushConverter">
            <hic:BooleanToBrushConverter.TrueValue>
                <SolidColorBrush Color="Green" /> 
            </hic:BooleanToBrushConverter.TrueValue>
            <hic:BooleanToBrushConverter.FalseValue>
                <SolidColorBrush Color="Red" /> 
            </hic:BooleanToBrushConverter.FalseValue>
        </hic:BooleanToBrushConverter>
    </Window.Resources>
    <Interaction.Behaviors>
        <EventTriggerBehavior EventName="Closing">
            <InvokeCommandAction Command="{Binding Closed}" />
        </EventTriggerBehavior>
    </Interaction.Behaviors>
    <Grid>
        <Grid Margin="10">
            <StackPanel>
                <StackPanel.Styles>
                    <Style Selector="StackPanel">
                        <Setter Property="Margin" Value="0,0,0,8"></Setter>
                    </Style>
                </StackPanel.Styles>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                    <TextBlock Text="Theme" VerticalAlignment="Center" />
                    <Grid Width="80" Margin="20,0,0,0">
                        <ComboBox Width="130" Items="{Binding ThemeList}"
                                  SelectedItem="{Binding ThemeList.CurrentItem}" />
                    </Grid>
                </StackPanel>
                <TextBlock Grid.Column="0" Text="Save to Folder" HorizontalAlignment="Left"/>
                <Grid ColumnDefinitions="Auto,*,Auto">
                    <TextBox Grid.Column="1" hic:FocusExtensions.FocusOnLoaded="True"
                             Text="{Binding Settings.DestinationFolder}">
                        <Interaction.Behaviors>
                            <EventTriggerBehavior EventName="LostFocus">
                                <InvokeCommandAction Command="{Binding TestDestinationPath}" />
                            </EventTriggerBehavior>
                        </Interaction.Behaviors>
                    </TextBox>
                    <Button Classes="round" Grid.Column="2" Width="35"
                            Command="{Binding BrowseDestination}">
                        <ui:SymbolIcon Symbol="OpenFolder" FontSize="20" />
                    </Button>
                </Grid>
                <TextBlock Grid.Column="0" Text="{Binding DestinationPathError}" HorizontalAlignment="Left" 
                           FontSize="12" Foreground="Red" Height="16" />
                <TextBlock Grid.Column="0" Text="FFmpeg Path" HorizontalAlignment="Left" />
                <Grid ColumnDefinitions="Auto,*,Auto">
                    <TextBox Grid.Column="1" hic:FocusExtensions.FocusOnLoaded="True" 
                             Text="{Binding Settings.FFmpegPath}">
                        <Interaction.Behaviors>
                            <EventTriggerBehavior EventName="LostFocus">
                                <InvokeCommandAction Command="{Binding TestFFmpeg}" />
                            </EventTriggerBehavior>
                        </Interaction.Behaviors>
                    </TextBox>
                    <Button Classes="round" Grid.Column="2" Width="35"
                            Command="{Binding BrowseFFmpeg}">
                        <ui:SymbolIcon Symbol="OpenFile" FontSize="20" />
                    </Button>
                </Grid>
                <TextBlock Grid.Column="0" Text="{Binding FFmpegVersion}" HorizontalAlignment="Left" FontSize="12"
                           Foreground="{Binding IsFFmpegPathValid, Converter={StaticResource BooleanToBrushConverter}}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                <StackPanel.Styles>
                    <Style Selector="Button">
                        <Setter Property="Margin" Value="3,0,0,0" />
                    </Style>
                </StackPanel.Styles>
                <Button Width="65" Classes="round" Command="{Binding RestoreDefault}" Content="Default" />
                <Button Width="65" Classes="round" Command="{Binding Apply}" Content="Apply" />
                <Button Width="65" Classes="round accent" Command="{Binding Ok}" IsDefault="True" Content="OK" />
                <Button Width="65" Classes="round" Command="{Binding Cancel}" IsCancel="true" Content="Cancel" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>